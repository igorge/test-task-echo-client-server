//================================================================================================================================================
// FILE: utc_time.h
// (c) GIE 2017-10-22  20:19
//
//================================================================================================================================================
#ifndef H_GUARD_UTC_TIME_2017_10_22_20_19
#define H_GUARD_UTC_TIME_2017_10_22_20_19
//================================================================================================================================================
#pragma once
//================================================================================================================================================
#include "platform/time.hpp"

#include <string>
#include <array>
#include <ctime>
#include <cassert>
//================================================================================================================================================
namespace echosrv {

    inline std::string utc_time() {
        auto t = std::time(nullptr);
        struct tm gm_time_;
        auto gm_time = gmtime_r(&t, &gm_time_);
        assert(gm_time);

        std::array<char, 20> buf;
        auto const r = strftime(buf.data(), buf.size(),  "%Y-%m-%d %H:%M:%S", gm_time);
        if (r!=buf.size()-1) {
            assert(false);
            throw std::runtime_error("unexpected");
        }

        return {buf.data(), r};
    }

}
//================================================================================================================================================
#endif
//================================================================================================================================================
